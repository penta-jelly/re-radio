version: '3'
services:
  graphql_service:
    build:
      context: .
      dockerfile: Dockerfile.dev
    volumes:
      - .:/user/app
      - ./node_modules:/user/app/node_modules
    command: >
      sh -c "npm run build && wait-on http://prisma:${PRISMA_PORT} && npm run prisma:deploy --force && npm run dev"
  real-time_service:
    build:
      context: .
      dockerfile: Dockerfile.dev
    volumes:
      - .:/user/app
      - ./node_modules:/user/app/node_modules
    command: >
      sh -c "wait-on http://graphql_service:8000/status && npm run dev:real-time-radio"
